<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocab Cards</title>
    <style>
        :root {
            /* Light theme variables */
            --bg-primary: #ffffff;
            --bg-secondary: #f7f7f7;
            --text-primary: #333333;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --accent-color: #3b82f6;
            --card-shadow: 0 1px 3px rgba(0,0,0,0.1);
            --hover-bg: #f3f4f6;
        }

        [data-theme="dark"] {
            /* Dark theme variables */
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --text-primary: #f3f4f6;
            --text-secondary: #9ca3af;
            --border-color: #374151;
            --accent-color: #60a5fa;
            --card-shadow: 0 1px 3px rgba(0,0,0,0.3);
            --hover-bg: #374151;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
            line-height: 1.5;
            min-height: 100vh;
        }

        /* Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .topbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .app-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
        }

        /* Cards */
        .card {
            background-color: var(--bg-primary);
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        /* Grid layout */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        /* Buttons */
        .btn {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn:hover {
            background-color: var(--hover-bg);
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            opacity: 0.9;
        }

        /* Form elements */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .form-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        /* Utility classes */
        .hidden {
            display: none;
        }

        .mb-1 {
            margin-bottom: 0.25rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .text-secondary {
            color: var(--text-secondary);
        }

        /* Flashcard specific styles */
        .flashcard {
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: pointer;
        }

        .flashcard-word {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .flashcard-meaning {
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .flashcard-example {
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .rating-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="topbar">
            <div class="app-title">Vocab Cards</div>
            <div class="nav-buttons">
                <button id="btnLibrary" class="btn">Library</button>
                <button id="btnStudy" class="btn">Study</button>
                <button id="btnToggleDark" class="btn">🌙</button>
            </div>
        </div>

        <section id="viewLibrary">
            <div class="grid">
                <!-- Left card: Form + Search/List -->
                <div class="card">
                    <h2 class="card-title">Add New Word</h2>
                    <form id="wordForm">
                        <div class="form-group">
                            <label class="form-label" for="word">Word</label>
                            <input type="text" id="word" class="form-input" placeholder="Enter word or phrase">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="meaning">Meaning</label>
                            <textarea id="meaning" class="form-input" rows="2" placeholder="Enter definition"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="example">Example</label>
                            <textarea id="example" class="form-input" rows="2" placeholder="Enter example usage"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="notes">Notes/Context (optional)</label>
                            <textarea id="notes" class="form-input" rows="2" placeholder="Enter any additional notes"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="folder">Folder</label>
                            <input type="text" id="folder" class="form-input" placeholder="Enter folder name">
                        </div>
                        <button type="submit" class="btn btn-primary">Add Word</button>
                    </form>

                    <div class="mb-4"></div>
                    
                    <h2 class="card-title">Your Words</h2>
                    <div class="form-group">
                        <input type="text" id="search" class="form-input" placeholder="Search words...">
                    </div>
                    <div id="wordsList">
                        <!-- Words will be listed here -->
                        <div class="text-secondary">No words added yet</div>
                    </div>
                </div>

                <!-- Right card: Study stats and folder management -->
                <div class="card">
                    <h2 class="card-title">Study Statistics</h2>
                    <div class="mb-2">
                        <div class="text-secondary">Total words:</div>
                        <div id="totalWords">0</div>
                    </div>
                    <div class="mb-2">
                        <div class="text-secondary">Words studied today:</div>
                        <div id="wordsStudied">0</div>
                    </div>
                    
                    <div class="mb-4"></div>
                    
                    <h2 class="card-title">Folder Management</h2>
                    <div class="form-group">
                        <label class="form-label" for="folderManage">Manage Folders</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <select id="folderManage" class="form-input" style="flex-grow: 1;">
                                <!-- Folders will be populated here -->
                            </select>
                            <button id="btnRenameFolder" class="btn">Rename</button>
                        </div>
                    </div>
                    
                    <div class="mb-2">
                        <div class="text-secondary">Your Folders:</div>
                        <div id="foldersList">
                            <!-- Folders will be listed here -->
                            <div>No folders created yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="viewStudy" class="hidden">
            <div class="card mb-4">
                <h2 class="card-title">Study Settings</h2>
                <div class="form-group">
                    <label class="form-label" for="studyFolder">Select Folder to Study</label>
                    <select id="studyFolder" class="form-input">
                        <option value="all">All Folders</option>
                        <!-- Folders will be populated here -->
                    </select>
                </div>
                <button id="btnStartStudy" class="btn btn-primary">Start Study Session</button>
            </div>
            
            <div class="card flashcard" id="flashcard">
                <div id="flashcardFront">
                    <div class="flashcard-word" id="studyWord">Word</div>
                    <div class="text-secondary">Click to reveal meaning</div>
                </div>
                <div id="flashcardBack" class="hidden">
                    <div class="flashcard-meaning" id="studyMeaning">Meaning</div>
                    <div class="flashcard-example" id="studyExample">Example</div>
                    <div class="text-secondary" id="studyNotes">Notes</div>
                </div>
            </div>
            
            <div class="rating-buttons">
                <button class="btn" id="btnHard">Hard</button>
                <button class="btn" id="btnMedium">Medium</button>
                <button class="btn" id="btnEasy">Easy</button>
                <button class="btn" id="btnNext">Next</button>
            </div>
        </section>
    </div>

    <script>
        // DOM element references
        const btnLibrary = document.getElementById('btnLibrary');
        const btnStudy = document.getElementById('btnStudy');
        const btnToggleDark = document.getElementById('btnToggleDark');
        const viewLibrary = document.getElementById('viewLibrary');
        const viewStudy = document.getElementById('viewStudy');
        const flashcard = document.getElementById('flashcard');
        const flashcardFront = document.getElementById('flashcardFront');
        const flashcardBack = document.getElementById('flashcardBack');
        const wordForm = document.getElementById('wordForm');
        const wordsList = document.getElementById('wordsList');
        const searchInput = document.getElementById('search');
        const totalWordsEl = document.getElementById('totalWords');
        const wordsStudiedEl = document.getElementById('wordsStudied');
        const foldersListEl = document.getElementById('foldersList');
        const btnHard = document.getElementById('btnHard');
        const btnMedium = document.getElementById('btnMedium');
        const btnEasy = document.getElementById('btnEasy');
        const btnNext = document.getElementById('btnNext');
        const studyFolderSelect = document.getElementById('studyFolder');
        const btnStartStudy = document.getElementById('btnStartStudy');
        const folderManageSelect = document.getElementById('folderManage');
        const btnRenameFolder = document.getElementById('btnRenameFolder');
        
        // Data storage
        let vocabData = {
            words: [],
            stats: {
                wordsStudied: 0,
                lastStudyDate: null
            }
        };
        
        let currentStudyIndex = 0;
        let studyQueue = [];
        
        // Load data from localStorage
        function loadData() {
            const savedData = localStorage.getItem('vocabCardsData');
            if (savedData) {
                vocabData = JSON.parse(savedData);
            }
            updateStats();
            renderWordsList();
            renderFoldersList();
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('vocabCardsData', JSON.stringify(vocabData));
        }
        
        // Add new word
        function addWord(wordData) {
            const newWord = {
                id: Date.now().toString(),
                word: wordData.word,
                meaning: wordData.meaning,
                example: wordData.example,
                notes: wordData.notes,
                folder: wordData.folder || 'General',
                dateAdded: new Date().toISOString(),
                difficulty: 'medium', // default difficulty
                lastStudied: null
            };
            
            vocabData.words.push(newWord);
            saveData();
            updateStats();
            renderWordsList();
            renderFoldersList();
        }
        
        // Delete word
        function deleteWord(id) {
            vocabData.words = vocabData.words.filter(word => word.id !== id);
            saveData();
            updateStats();
            renderWordsList();
            renderFoldersList();
        }
        
        // Update statistics
        function updateStats() {
            // Update total words count
            totalWordsEl.textContent = vocabData.words.length;
            
            // Check if last study was today
            const today = new Date().toDateString();
            const lastStudyDate = vocabData.stats.lastStudyDate ? new Date(vocabData.stats.lastStudyDate).toDateString() : null;
            
            // Reset study count if it's a new day
            if (lastStudyDate !== today) {
                vocabData.stats.wordsStudied = 0;
            }
            
            // Update words studied today
            wordsStudiedEl.textContent = vocabData.stats.wordsStudied;
        }
        
        // Render words list
        function renderWordsList(searchTerm = '', folderFilter = '') {
            // Clear current list
            wordsList.innerHTML = '';
            
            // Filter words by search term and folder if provided
            let filteredWords = vocabData.words;
            
            // Apply folder filter first if provided
            if (folderFilter) {
                filteredWords = filteredWords.filter(word => word.folder === folderFilter);
            }
            
            // Then apply search term filter if provided
            if (searchTerm) {
                const term = searchTerm.toLowerCase();
                filteredWords = filteredWords.filter(word => 
                    word.word.toLowerCase().includes(term) || 
                    word.meaning.toLowerCase().includes(term)
                );
            }
            
            // Show message if no words
            if (filteredWords.length === 0) {
                const noWordsMsg = document.createElement('div');
                noWordsMsg.className = 'text-secondary';
                
                if (folderFilter && searchTerm) {
                    noWordsMsg.textContent = `No matching words found in folder "${folderFilter}"`;
                } else if (folderFilter) {
                    noWordsMsg.textContent = `No words in folder "${folderFilter}"`;
                } else if (searchTerm) {
                    noWordsMsg.textContent = 'No matching words found';
                } else {
                    noWordsMsg.textContent = 'No words added yet';
                }
                
                wordsList.appendChild(noWordsMsg);
                return;
            }
            
            // Add folder filter indicator if active
            if (folderFilter) {
                const filterIndicator = document.createElement('div');
                filterIndicator.className = 'mb-2';
                filterIndicator.style.display = 'flex';
                filterIndicator.style.justifyContent = 'space-between';
                filterIndicator.style.alignItems = 'center';
                filterIndicator.style.padding = '0.5rem';
                filterIndicator.style.backgroundColor = 'var(--bg-secondary)';
                filterIndicator.style.borderRadius = '0.25rem';
                
                const filterText = document.createElement('div');
                filterText.textContent = `Showing folder: ${folderFilter}`;
                
                const clearBtn = document.createElement('button');
                clearBtn.className = 'btn';
                clearBtn.textContent = 'Clear';
                clearBtn.style.padding = '0.15rem 0.5rem';
                clearBtn.style.fontSize = '0.75rem';
                clearBtn.addEventListener('click', () => renderWordsList(searchTerm));
                
                filterIndicator.appendChild(filterText);
                filterIndicator.appendChild(clearBtn);
                
                wordsList.appendChild(filterIndicator);
            }
            
            // Create list of words
            filteredWords.forEach(word => {
                const wordItem = document.createElement('div');
                wordItem.className = 'mb-2';
                wordItem.style.padding = '0.5rem';
                wordItem.style.borderBottom = '1px solid var(--border-color)';
                
                const wordTitle = document.createElement('div');
                wordTitle.style.display = 'flex';
                wordTitle.style.justifyContent = 'space-between';
                wordTitle.style.alignItems = 'center';
                
                const wordText = document.createElement('strong');
                wordText.textContent = word.word;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn';
                deleteBtn.textContent = '✕';
                deleteBtn.style.padding = '0.25rem 0.5rem';
                deleteBtn.addEventListener('click', () => deleteWord(word.id));
                
                wordTitle.appendChild(wordText);
                wordTitle.appendChild(deleteBtn);
                
                const wordMeaning = document.createElement('div');
                wordMeaning.textContent = word.meaning;
                
                const wordFolder = document.createElement('div');
                wordFolder.className = 'text-secondary';
                wordFolder.style.fontSize = '0.8rem';
                wordFolder.textContent = `Folder: ${word.folder}`;
                
                wordItem.appendChild(wordTitle);
                wordItem.appendChild(wordMeaning);
                wordItem.appendChild(wordFolder);
                
                wordsList.appendChild(wordItem);
            });
        }
        
        // Render folders list
        function renderFoldersList() {
            // Clear current list
            foldersListEl.innerHTML = '';
            
            // Get unique folders
            const folders = [...new Set(vocabData.words.map(word => word.folder))];
            
            // Show message if no folders
            if (folders.length === 0) {
                const noFoldersMsg = document.createElement('div');
                noFoldersMsg.textContent = 'No folders created yet';
                foldersListEl.appendChild(noFoldersMsg);
                return;
            }
            
            // Create list of folders with word counts
            folders.forEach(folder => {
                const count = vocabData.words.filter(word => word.folder === folder).length;
                const folderItem = document.createElement('div');
                folderItem.style.display = 'flex';
                folderItem.style.justifyContent = 'space-between';
                folderItem.style.alignItems = 'center';
                folderItem.style.padding = '0.25rem 0';
                folderItem.style.cursor = 'pointer';
                
                const folderName = document.createElement('span');
                folderName.textContent = `${folder} (${count})`;
                
                const viewBtn = document.createElement('button');
                viewBtn.className = 'btn';
                viewBtn.textContent = 'View';
                viewBtn.style.padding = '0.15rem 0.5rem';
                viewBtn.style.fontSize = '0.75rem';
                
                // Add click event to filter words by folder
                viewBtn.addEventListener('click', () => {
                    renderWordsList('', folder);
                });
                
                folderItem.appendChild(folderName);
                folderItem.appendChild(viewBtn);
                
                foldersListEl.appendChild(folderItem);
            });
            
            // Also update the study folder select dropdown
            updateStudyFolderSelect(folders);
        }
        
        // Update the folder select dropdowns
        function updateStudyFolderSelect(folders) {
            // Clear current options except "All Folders" in study dropdown
            while (studyFolderSelect.options.length > 1) {
                studyFolderSelect.remove(1);
            }
            
            // Clear all options in folder management dropdown
            folderManageSelect.innerHTML = '';
            
            // Add folder options to both dropdowns
            folders.forEach(folder => {
                // Add to study dropdown
                const studyOption = document.createElement('option');
                studyOption.value = folder;
                studyOption.textContent = folder;
                studyFolderSelect.appendChild(studyOption);
                
                // Add to folder management dropdown
                const manageOption = document.createElement('option');
                manageOption.value = folder;
                manageOption.textContent = folder;
                folderManageSelect.appendChild(manageOption);
            });
        }
        
        // Rename folder
        function renameFolder(oldName, newName) {
            if (!newName || oldName === newName) return;
            
            // Check if new folder name already exists
            const folderExists = vocabData.words.some(word => word.folder === newName);
            if (folderExists) {
                const mergeConfirm = confirm(`Folder "${newName}" already exists. Merge folders?`);
                if (!mergeConfirm) return;
            }
            
            // Update all words in the old folder
            vocabData.words.forEach(word => {
                if (word.folder === oldName) {
                    word.folder = newName;
                }
            });
            
            // Save and update UI
            saveData();
            renderWordsList();
            renderFoldersList();
        }
        
        // Prepare study session
        function prepareStudySession(folderName = 'all') {
            // Reset study queue with filtered words
            if (folderName === 'all') {
                studyQueue = [...vocabData.words];
            } else {
                studyQueue = vocabData.words.filter(word => word.folder === folderName);
            }
            
            // Hide the study settings and show the flashcard
            document.querySelector('.card.mb-4').style.display = 'none';
            document.querySelector('.card.flashcard').style.display = 'flex';
            document.querySelector('.rating-buttons').style.display = 'flex';
            
            // Shuffle the queue
            studyQueue.sort(() => Math.random() - 0.5);
            
            currentStudyIndex = 0;
            
            // Load first card if we have words
            if (studyQueue.length > 0) {
                loadCurrentCard();
            } else {
                // Show message if no words to study
                document.getElementById('studyWord').textContent = folderName === 'all' ? 
                    'No words to study' : 
                    `No words in folder "${folderName}"`;
                document.getElementById('studyMeaning').textContent = 'Add words in the Library section';
                document.getElementById('studyExample').textContent = '';
                document.getElementById('studyNotes').textContent = '';
            }
        }
        
        // Load current flashcard
        function loadCurrentCard() {
            if (currentStudyIndex < studyQueue.length) {
                const currentWord = studyQueue[currentStudyIndex];
                
                // Reset card to front side
                flashcardFront.classList.remove('hidden');
                flashcardBack.classList.add('hidden');
                
                // Update card content
                document.getElementById('studyWord').textContent = currentWord.word;
                document.getElementById('studyMeaning').textContent = currentWord.meaning;
                document.getElementById('studyExample').textContent = currentWord.example || 'No example provided';
                document.getElementById('studyNotes').textContent = currentWord.notes || '';
                
                // Mark word as studied
                const today = new Date().toISOString();
                currentWord.lastStudied = today;
                vocabData.stats.lastStudyDate = today;
                vocabData.stats.wordsStudied++;
                
                saveData();
                updateStats();
            } else {
                // End of study session
                document.getElementById('studyWord').textContent = 'Study Complete!';
                document.getElementById('studyMeaning').textContent = 'You have reviewed all words';
                document.getElementById('studyExample').textContent = '';
                document.getElementById('studyNotes').textContent = '';
            }
        }
        
        // Move to next card
        function nextCard() {
            currentStudyIndex++;
            loadCurrentCard();
        }
        
        // Update word difficulty
        function updateDifficulty(difficulty) {
            if (currentStudyIndex < studyQueue.length) {
                const wordId = studyQueue[currentStudyIndex].id;
                const wordIndex = vocabData.words.findIndex(w => w.id === wordId);
                
                if (wordIndex !== -1) {
                    vocabData.words[wordIndex].difficulty = difficulty;
                    saveData();
                }
                
                nextCard();
            }
        }

        // Switch between views
        function switchView(viewName) {
            if (viewName === 'library') {
                viewLibrary.classList.remove('hidden');
                viewStudy.classList.add('hidden');
                btnLibrary.classList.add('btn-primary');
                btnStudy.classList.remove('btn-primary');
            } else if (viewName === 'study') {
                viewLibrary.classList.add('hidden');
                viewStudy.classList.remove('hidden');
                btnLibrary.classList.remove('btn-primary');
                btnStudy.classList.add('btn-primary');
                
                // Reset study view to show settings
                document.querySelector('.card.mb-4').style.display = 'block';
                document.querySelector('.card.flashcard').style.display = 'none';
                document.querySelector('.rating-buttons').style.display = 'none';
            }
        }

        // Toggle dark mode
        function toggleDarkMode() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            if (isDark) {
                document.documentElement.removeAttribute('data-theme');
                btnToggleDark.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
                btnToggleDark.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Flip flashcard
        function toggleFlashcard() {
            flashcardFront.classList.toggle('hidden');
            flashcardBack.classList.toggle('hidden');
        }

        // Event listeners
        btnLibrary.addEventListener('click', () => switchView('library'));
        btnStudy.addEventListener('click', () => switchView('study'));
        btnToggleDark.addEventListener('click', toggleDarkMode);
        flashcard.addEventListener('click', toggleFlashcard);
        btnStartStudy.addEventListener('click', () => prepareStudySession(studyFolderSelect.value));
        btnRenameFolder.addEventListener('click', () => {
            const oldName = folderManageSelect.value;
            if (!oldName) {
                alert('Please select a folder to rename');
                return;
            }
            
            const newName = prompt(`Rename folder "${oldName}" to:`, oldName);
            if (newName) {
                renameFolder(oldName, newName);
            }
        });
        
        // Form submission
        wordForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const wordData = {
                word: document.getElementById('word').value.trim(),
                meaning: document.getElementById('meaning').value.trim(),
                example: document.getElementById('example').value.trim(),
                notes: document.getElementById('notes').value.trim(),
                folder: document.getElementById('folder').value.trim() || 'General'
            };
            
            // Validate required fields
            if (!wordData.word || !wordData.meaning) {
                alert('Word and meaning are required!');
                return;
            }
            
            // Add the word
            addWord(wordData);
            
            // Reset form
            wordForm.reset();
        });
        
        // Search functionality
        searchInput.addEventListener('input', (e) => {
            renderWordsList(e.target.value.trim());
        });
        
        // Study buttons
        btnHard.addEventListener('click', () => updateDifficulty('hard'));
        btnMedium.addEventListener('click', () => updateDifficulty('medium'));
        btnEasy.addEventListener('click', () => updateDifficulty('easy'));
        btnNext.addEventListener('click', nextCard);

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved data
            loadData();
            
            // Set initial view
            switchView('library');
            btnLibrary.classList.add('btn-primary');
            
            // Check for saved theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                btnToggleDark.textContent = '☀️';
            }
        });
    </script>
</body>
</html>